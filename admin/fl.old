<?LassoScript //>var('fromMetoRoot') = '../';Include('../config.lasso');Include('../gen/session.inc');Library('../inc/library.inc');var('myStylesheet') = 'admin.css';var('myInc') = 'inc/';var('myImages') = 'images/';// init the basic options datatypevar('basicOptions') = LB_basicOptions;var('menu')  = $fromMetoRoot + $myInc + 'adminmenu.lasso';var('footer')= $fromMetoRoot + $myInc + 'adminfooter.inc';// some values here override those in config.lassovar('contents')= $fromMetoRoot + 'gen/adminpage_monster.inc';If( $lang == 'fi');var('page_title')='Tiedostojen lataus';Else;var('page_title')='File Uploads';/If;var('pageSecuritylevel') = Integer(LB_GetOption('fileupload_minlevel')); var('rectype_en') = 'file';var('rectype_en_part') = 'files';var('rectype_fi') = 'tiedosto';var('rectype_fi_part') = 'tiedostoja';var('viewtype') = 'listview'; // formview, listviewvar('maxrecords_formview') = 1;   var('maxrecords_listview') = 25;   var('dbtype') = 'mysql';   // fmp, mysql (vaikuttaa pvm-k‰sittelyynvar('updatebehavior') = 1;   // 1 or 2 (see below)// behavior #1: search kept, updated rec shown only if search allows this// 		(keyvalue nulled after update)//		(good for listview)// behavior #2: search bypassed, only updated rec shown// 		(keyvalue kept, hakulomake emptied)//		(sopii formview-n‰kym‰‰n)var('searchBehavior') = 1;   // 1 or 2 (see below)// searchBehavior #1: if searchform is empty, then find all// searchBehavior #2: if searchform is empty, then find nothingvar('action') = '';var('speakBubble') = '';var('keyvalue')=Action_Param('keyvalue');var('skip')=Action_Param('skip');var('haku')=Action_Param('haku');var('size1default')='600px'; // default text size, textarea cols)var('size2default')='4';  // default textarea rows)var('myTable')='uploads';var('publicPage')=''; // don't comment outvar('defaultClass')='pieni'; // normaalisti "pieni" // for how to use $searchFields and $editFields, // see the beginning of adminpage_monster.inc// this one ONLY for $editfields, for $searchfields scroll downvar('cat_temp') = "[If( $emptyform == 'yes')][Var('comparisonValue'= '-1')][Else][Var('comparisonvalue' = $fieldValue)][/If]    [If( $emptyform == 'yes')]Post-related    <input type=\"hidden\" name=\"upl_catid\" value=\"-1\">    [Else]    [Inline(-FindAll,$dbConfig,-table=$table_prefix + 'uploadcats',      -KeyField='id',-SortField='upc_name')]	<select name=\"upl_catid\" size=\"1\">		<option value=\"-1\"[If( $fieldvalue ==		  \"-1\")] SELECTED[/If]>None (post-related file)</option>	    [Records]		<option value=\"[Field('id')]\"[If( $fieldvalue ==		  Field('id'))] SELECTED[/If]>[Field('upc_name')]</option>	    [/Records]	</select>    [/Inline]    [/If]";// for $searchfieldsvar('searchcat_temp') = "[If( $emptyform == 'yes')][Var('comparisonValue'= '-1')][Else][Var('comparisonvalue' = $fieldValue)][/If]    [If( $emptyform == 'yes')]Post-related    <input type=\"hidden\" name=\"upl_catid\" value=\"-1\">    [Else]    [Inline(-FindAll,$dbConfig,-table=$table_prefix + 'uploadcats',      -KeyField='id',-SortField='upc_name')]	<select name=\"searchparam2\" size=\"1\">		<option value=\"\">--Any</option>		[Records]		<option value=\"[Field('id')]\"[If( $fieldvalue ==		  Field('id'))] SELECTED[/If]>[Field('upc_name')]</option>	    [/Records]	</select>    [/Inline]    [/If]";var('user_temp') = '    [If( $emptyform == \'yes\')]	[Var(\'myuser\' = $user_ses)]	[Else]	[Var(\'myuser\' = $fieldvalue)]    [/If]    [Inline(-search,$dbConfig, -table=$table_prefix + \'users\',    -KeyField=\'id\',\'id\'=$myuser)]    <A HREF="use-edit.lasso?id=[Field(\'id\')]" TITLE="See user data">    [Field(\'use_nickname\')]</A>    [/Inline]    <input type="hidden" name="upl_userid" value="[$myuser]">    ';var('postid_temp') = "    [If( Field('upl_catid') == '-1')]    [Inline(-search,$dbConfig, -table=$table_prefix + 'posts',    -KeyField='id','id'=$fieldvalue)]    <A HREF=\"man-postedit.lasso?id=[$fieldvalue]\" TITLE=\"See the post\">    [Field('pos_title')]</A>    [/Inline]    [Else]    --    [/If]";// search formvar('searchFields')=Array(Array('id','ID','hidden','','','','','','','','eq'),Array('upl_catid','Category','override','','','','','',$searchcat_temp,'nobreak','eq'),Array('upl_name','Filename','text','','15','','','','','nobreak'),);// edit formvar('editFields')=Array(Array('id','ID','nosave','','','','','',''),Array('upl_catid','File Category','override','','','','','',$cat_temp),Array('upl_postid','To Post','nosave','','','','','',$postid_temp),Array('upl_name','Filename','nosave','','','','','','<A HREF="upl-fileedit.lasso?id=[Field(\'id\')]" TITLE="See details">[Field(\'upl_name\')]</A>'),Array('upl_customsortcode','Custom sort code','text','','40px','','','',''),// Array('upl_userid','Uploaded by','override','','','','','',$user_temp),);// add formvar('addFields')=$editFields;// define sorting for the main search inlinevar('sortstuff') = Array('-sortfield' = 'id','-sortorder' = 'descending');var( 'defaultSearch') = (Array);	// userlevel adjustments// none//  buttonlist (say 'yes' or 'no' to each item)var('buttonlist') = Array('add'='no','update'='yes','delete'='yes');// var('formTargetpage') = '';   // if target=self, comment this outvar('customValidations') = 'no'; 	// if yes, the associated include file must be in placevar('customPostprocess') = 'no'; var('allowFileupload') = 'yes';   Include('../gen/frame_admin.inc');?>