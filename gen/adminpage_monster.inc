<div class="center"><?LassoScript //>/*  SHORT HELP FOR $searchFields and $editFields   (for their definition, see the stub pages)1=fieldnames, 2=legend, 3=input type (nosave,creationdate,moddate,hidden,noentry,saveIfNotEmpty,text,textarea,textarea_fckeditor,select,radio,checkbox,override)** "creationdate", "moddate": set #8 to "date"** on search form: a "hidden" field can be searched with get action ** - in that case add to the link "search=get"** on edit form, the default value for "hidden" field can be entered in slot 12** for "creationdate", "moddate": remember to set #8 to "date" or "datetime"4=validations (req, unique); separated by ; (note: date & time fields will be automatically validated, when #8 is set to date or time)5=size1 (=text:size, textarea:cols; if empty, use default)        (for select/radio: list of values, separated by ;        (for checkbox, db value for checked checkbox)6=size2 (textarea:rows; if empty, use default)         (for select/radio: list of visible texts, sep. by ;7=help text8= date,time,datetime (the value will be formatted on the editform before showing; for date and time, there is automatic input validation)9 = override field presentation on editform or searchform with this data(set #3 to "nosave", if you want the field data to be displayed before the #9 code, or "override", if you don't want that. If you want data to be saved, #9 should include the input field or other such elementWATCH OUT: setting #3 to override creates an empty entry in inlinestuff for the field mentioned in #1! This can have serious side effects: For example, DON'T set #1 to "id", when #3 is "override", and #9 is not related to id at all. #1 cannot be empty, either. My best solution so far is to mention in #1 a real fieldname, for example one that always gets a value on adds & updates, like moddate (if present). That way the non-empty entry in $inlinestuff will override the empty entry.  10 (on searchform, coming to editform?) =linebreak (nobreak)11 (on searchform) = search operator (eq, neq, lt, ft, etc.)11 (on editform or addform) = encryption (md5,blowfish)12 (on addform) = default value (used only if 3=hidden)*/// 'test: '; action_params; '<br>';Variable:'action' = '';    If: !(Variable_Defined:'uploadForm');	Variable:'uploadForm' = (Action_Param:'uploadForm'); // see stub file    /If;    If: !(Variable_Defined:'emptyForm');	Variable:'emptyForm' = (Action_Param:'emptyForm'); // see stub file    /If;    If: !(Variable_Defined:'formTargetpage'); // see stub file    Variable:'formTargetpage' = $myfilename;    /If;    If: !(Variable_Defined:'allowFileupload'); // see stub file    Variable:'allowFileupload' = '';    /If;    If: !(Variable_Defined:'speakBubble_style');     Variable:'speakBubble_style' = '';    /If;Variable:'keyvalue'=(Action_Param:'keyvalue');Variable:'skip'=(Action_Param:'skip');Variable:'searchType'=(Action_Param:'searchType');Variable:'hakuinlinestuff'=(Array);Variable:'linkstuff'='';Variable:'formstuff'='';Variable:'searchToggle'='';Variable:'dbChange'=integer;Variable:'dbChange_error'='';Variable:'reqFieldsFound'='';Variable:'date_showFormat' = 	($basicOptions -> 'date_format') + ' ' + 	($basicOptions -> 'time_format');Variable:'fieldCounter' = 0; /* fieldCounter is used to label searchform fieldsbecause sometimes there are 2 searchfields on the searchform  both targeting the same db field; thus dbfieldname is not adequateas a label. Also, searchform output must never use formparam names that could be identical to the editform formparam names*/// define actionIf: (Action_Param:'add_action')!='';  $action = 'add_action';  $dbChange = 1;Else: (Action_Param:'update_action')!='';  $action = 'update_action';  $dbChange = 1;Else: (Action_Param:'delete_action')!='';  $action = 'delete_action';  $dbChange = 1;Else: (Action_Param:'delet2_action')!='';  $action = 'delet2_action';  $dbChange = 1;Else: (Action_Param:'upload')!='';  $action = 'upload';  $dbChange = 1;/If;// file upload vars    If: $allowFileupload == 'yes';	Var:'content_path' 	= (LB_getOption:'fileupload_realpath');	Var:'upload_filename' 	= (Action_Param:'upload_filename');	Var:'upload_path'     	= (Action_Param:'upload_path');	Var:'upload_description'= (Action_Param:'upload_description');	Var:'upl_catid' 	= (Action_Param:'upl_catid');	// this one for file remove (in LassoBlogger, page upl-list.lasso)	Var:'file' = (Action_Param:'file');	// check content_path (defined in Options)	If: $content_path == '';	    $speakBubble = 'To facilitate file uploads, please set the option <code>fileupload_realpath</code> on admin page Options > Manage Files!';	Else: !($content_path -> (EndsWith:'/'));	    $content_path += '/';	/If;	If: !($content_path -> (BeginsWith:'/'));	    $speakBubble = 'The option <code>fileupload_realpath</code> on the admin page Options > Manage Files should begin with a slash! Please correct';	/If;	If: $speakBubble != '';	    Include:$fromMetoRoot + 'inc/speakBubble.inc';	/If;    /If; // end file upload varsIterate: $searchFields,(Var:'this');    $fieldCounter += 1;    // search op? 20070124    Var: 'searchOp' = String;    If: ($this -> Size) > 10;	$searchOp = $this -> (Get:11);     /If;    Variable:'fname'= $this -> (Get:1);		   // for links & db search    Variable:'fname_forForms'= 'searchparam' + $fieldCounter;// for forms    // capture searchparam value to var    If: $searchType == 'post';	Var:('haku' + $fname) = (Action_Param:$fname_forForms);     Else: $searchType == 'link';	Var:('haku' + $fname) = (Action_Param:$fname_forForms);     Else; // searchType=get	Var:('haku' + $fname) = (Action_Param:$fname); 	    // we may have params from the  address line of browser    /If;    If:(Var:('haku' + $fname)); // if searchfield not empty	$linkstuff += $fname_forForms + '=' + (Variable:('haku'+$fname))+'&';	$formstuff += '<input type=\"hidden\" name=\"'+ $fname_forForms + 		'\" value=\"' + (Var:('haku'+$fname))+'\">\r';	$searchToggle = 'doSearch'; // jos ei yhtään hakutermiä, 				    // ja riippuen searchbehavior-				    // muuttujasta, hakua ei ehkä				    // tehdä	If: ($this -> (Get:8)) == 'date' || ($this -> (Get:8)) == 'timestamp';	// case: date & timestamp (pvm-kentät)	    If:(Date:(Var:('haku'+$fname)),-Format=$date_showformat) -> Type == 'date';		// if wellformed		If: $searchOp;		$hakuinlinestuff -> (Insert:'-Op' = $searchOp);		/If;		$hakuinlinestuff -> (Insert:$fname = 		(Date_Format:		    (Date:(Variable:('haku'+$fname)),-Format=$date_showformat)		),		  -Format=$dbformat	        );	    /If;	// case: other cases	Else;	    If: $searchOp;	    $hakuinlinestuff -> (Insert:'-Op' = $searchOp);	    /If;	    $hakuinlinestuff -> (Insert:$fname = (Variable:('haku'+$fname)));	/If;    /If; // if searchfield not empty/Iterate;// 'Test: linkstuff = ' + $linkstuff + '<br>';// add -MaxRecords to hakuinlinestuff    If:   $viewtype == 'listview';	$hakuinlinestuff -> (Insert:'-MaxRecords' = $maxrecords_listview);     Else: $viewtype == 'formview';	$hakuinlinestuff -> (Insert:'-MaxRecords' = $maxrecords_formview);     /If;    // nämä pitää restauroida uudestaan -updaten jälkeen// add default search params to hakuinlinestuff    If:   $defaultSearch != (Array);	Variable:'i' = '';	Iterate: $defaultSearch, $i;	$hakuinlinestuff -> (Insert:($i->(Get:1)) = ($i->(Get:2)) ); 	/Iterate;    /If;// 'test: hakuinlinestuff pre processing = ' + $hakuinlinestuff + '<br>';Variable:'inlinestuff'=(Array);// make varsIterate: $editFields,(Variable:'this');    Var:'fname' 	= ($this -> (Get:1));    Var:'fname_forDB' 	= ($this -> (Get:1)) + '_forDB';    Var:$fname 		= (Action_Param:$fname);    Var:$fname_forDB 	= (Action_Param:$fname);    // exception: default value overrides previous var def    If: $this -> (get:3) == 'hidden' && $this -> (size) > 11; // 	If: $this -> (get:12);	    var:$fname_forDB = $this -> (get:12);	/if;    /if;/Iterate;//  *** validaatio - validation ***// #1. required fields// #2. unique fields// #3. date fields// #4. time fields// #5  email validation// #6. custom // #1. required fieldsIf: $action == 'add_action' || $action == 'update_action';Variable:'valuesMissing' = '';    Iterate: $editFields, $this;	If: ($this -> (Get:4)) >> 'req';	    If: (Var:($this -> (Get:1))) == '';	    $valuesMissing = 'yes';	    $speakBubble_style = 'color:#c00;font-size:120%;';		If: $lang=='fi';		$speakBubble +='Täytä kenttä <b>' + ($this -> (Get:2)) + '</b>!<br>';		Else;		$speakBubble +='Please give <b>' + ($this -> (Get:2)) + '</b>!<br>';		/If;	    /If;	/If;    /Iterate;    If: $valuesMissing;	If: $lang=='fi';	$speakBubble +='Yritä sitten uudelleen!<br>';	Else;	$speakBubble +='Then try again!<br>';	/If;    /If;/If; 			// if action add_action tai update_action// unique fields, emailIf: $action == 'add_action' || $action == 'update_action';		// if action==add_action    // #2. unique fields    Iterate: $editFields, $this;    If: ($this -> (Get:4)) >> 'unique';	inline: $dbConfig, -table=$table_prefix+$myTable,	-Op='eq',	$this -> (Get:1) = (Var:($this -> (get:1))),	-search;	If: (($action == 'add_action' && (Found_Count) > 0) ||	    ($action == 'update_action' && (Found_Count) > 1))  	    ;	    $speakBubble_style = 'color:#c00;font-size:120%;';// 	    $speak_image = 'speak_ani.gif';	    If: $lang == 'fi';		$speakBubble += 'Kentän <b>' + $this -> (get:2) + '</b> arvo on jo käytössä. Vaihda kentän arvo.<br>';	    Else;		$speakBubble += 'Duplicate value in the <b>'+$this -> (get:2) + '</b> fieldi.<br>';	    /If;	/If; // if found_count    /Inline;    /If; 			// end if unique    // #3 Date validaton    // (iterate is still open)    If: ($this -> (Get:8)) == 'date' && (Var:($this -> (Get:1))) != ''       && (Var:($this -> (Get:1))) != '0000-00-00' ; // if not empty	If: (Date:(Var:($this -> (Get:1))),-Format=$date_showformat) -> Type != 'Date'; // if not valid	    $speakBubble_style = 'color:#c00;font-size:120%;';//	    $speak_image = 'speak_ani.gif';	    If: $lang == 'fi';		$speakBubble += 'Päivämäärä kentässä <b>' + $this -> (get:2) + '</b> ei ole validi.<br> ';	    Else;		$speakBubble += 'The date ' + (Var:($this -> (get:1))) + ' in field <b>'+$this -> (get:2) + '</b> is not valid.<br>';	    /If;	/If; // end if not valid    /If;  // end date validation    // #4 Time validaton    // (iterate is still open)    If: ($this -> (Get:8)) == 'time' && (Var:($this -> (Get:1))) != '';	If: (Date:(Var:($this -> (Get:1))),-Format='%H:%M:%S') -> Type != 'Date'; // not valid	    $speakBubble_style = 'color:#c00;font-size:120%;';//	    $speak_image = 'speak_ani.gif';	    If: $lang == 'fi';		$speakBubble += 'Aika kentässä <b>' + $this -> (get:2) + '</b> ei ole validi.<br> ';	    Else;		$speakBubble += 'The time in field <b>'+$this -> (get:2) + '</b> is not valid.<br>';	    /If;	/If; // end if not valid    /If;  // end time validation    // #5 Email validaton    // (iterate is still open)    If: ($this -> (Get:4)) >> 'email' && (Var:($this -> (Get:1))) != '';	If: !(Valid_Email: (Var:($this -> (get:1))));	    $speakBubble_style = 'color:#c00;font-size:120%;';//	    $speak_image = 'speak_ani.gif';	    If: $lang == 'fi';		$speakBubble += 'Email-osoite kentässä <b>' + $this -> (get:2) + '</b> ei ole validi.<br> ';	    Else;		$speakBubble += 'The email address in field <b>'+$this -> (get:2) + '</b> is not valid.<br>';	    /If;	/If; // end if not valid    /If;  // end email validation    /Iterate;		// end the long iterate/If; 	// action    // #6. Custom validation    If: $customValidations == 'yes';    Include:$fromMetoRoot + 'admin/custom/validation/' + $myfilebody + '.inc';    /If;    // end custom validation// last thing -  the speakBubble handler	    If: $speakBubble != '';		Include: $fromMeToRoot + $myInc + 'speakBubble.inc';		Variable:'dbChange_error' = 'validation failed';	    /If; // end validation// transform vars where needed, and feed into inlinestuffIf: !($dbChange_error); // if no errors in validationIterate: $editFields,(Variable:'this');    Var:'fname' 	= ($this -> (Get:1));    Var:'fname_forDB' 	= ($this -> (Get:1)) + '_forDB';    // in this iterate, don't touch any (Var:$fname)    // ...except for dates, because in case of update error, date     // has to be in dbformat to be displayed properly...If: (($this->(Get:8)) == 'date'); // case date 	If: (Var:$fname) != ''	 && (Var:$fname) != '0000-00-00'; // if not empty	    // reformat for db	    Var:$fname_forDB = 	      (Date_Format:(Date:(Var:$fname),-Format=$date_showformat), -Format=$date_dbformat);	    Var:$fname = 	      (Date_Format:(Date:(Var:$fname),-Format=$date_showformat), -Format=$date_dbformat);	/If; Else: (($this->(Get:8)) == 'time'); // case time     If: (Var:$fname);	Variable:$fname_forDB = 	    (Date_Format:(Date:(Var:$fname),	    -Format=($basicOptions -> (Find:'time_showformat'))), 	    -Format='%H:%M:%S');    /If;Else: (($this->(Get:8)) == 'timestamp'); // case timestamp 	If: (Var:$fname); // if not empty	    Var:$fname_forDB = 	      (Date_Format:		(Date:(Var:$fname), -Format=$date_showformat), 		-Format='%Y%m%d%H%M%S');	/If; /If;	(Variable:$fname_forDB) -> Trim;	// check for design error	If: $fname -> (BeginsWith:'haku');	$speakBubble = 'Kentän nimi ei saa alkaa \"haku\"! Korjaa tietokanta ' +	'ja editFields-muuttuja!';	Include: $fromMeToRoot + $myInc + 'speakBubble.inc';	Abort;	/If;    // record field value to inlinestuff?    If: $this -> (Get:3) == 'creationDate';	    If: $action == 'add_action'; 		    If: $this -> (Get:8) == 'date';		    $inlinestuff -> (Insert:$fname 		      = (Date_Format:(Date),-Format=$date_dbformat));		    Else: $this -> (Get:8) == 'datetime';			$inlinestuff -> (Insert:$fname 			  = (Date_Format:(Date),-Format='%Q %T'));		    /If;	    /If;     Else: $this -> (Get:3) == 'modDate'; 		    If: $this -> (Get:8) == 'date';		    $inlinestuff -> (Insert:$fname 		      = (Date_Format:(Date),-Format=$date_dbformat));		    Else: $this -> (Get:8) == 'datetime';			$inlinestuff -> (Insert:($this -> (Get:1)) 			  = (Date_Format:(Date),-Format='%Q %T'));		    /If;    Else: $this -> (Get:3) == 'nosave' ||          ($this -> (Get:3) == 'saveIfNotEmpty' &&	  (Variable:$fname) == '');		// don't save    Else;	// save	    If: $this -> (Size) > 10; // if encrypt (#11) is defined		If: $this -> (Get:11) == 'md5';		    $inlinestuff -> (Insert:$fname = 		      (Encrypt_MD5:(Var:$fname_forDB)));		Else: $this -> (Get:11) == 'blowfish';		    $inlinestuff -> (Insert:$fname = 		      (Encrypt_Blowfish:(Var:$fname_forDB),-Seed=$seed));		Else;		    $inlinestuff -> (Insert:$fname = (Var:$fname_forDB));		/If;	    Else;	// encrypt not defined		    $inlinestuff -> (Insert:$fname = (Var:$fname_forDB));	    /If;    /If;	/Iterate;/If; // (end if dbChange_error)// create readable version of il-stuff    Var:'inlinestuff_readable' = String;    Var:'this' = Array;    Iterate:$inlinestuff, $this;	$inlinestuff_readable += ($this -> First);	$inlinestuff_readable += ' = "';	$inlinestuff_readable += ($this -> Second);	$inlinestuff_readable += '"<br>';    /iterate;         /* if dbChange=1  - processing begins */If: $dbChange ==1; If: $action=='update_action' && $dbChange_error == '';  // if actioninline: $dbConfig, -table=$table_prefix+$myTable,-keyfield='id',-keyvalue=$keyvalue,$inlinestuff,-update;if: (Error_CurrentError)!=(Error_NoError);	$dbChange_error = (Error_CurrentError);    If: $lang == 'fi';	$speakBubble='Tietueen päivitys ei onnistunut. Tietoja virheestä: '+	(Error_CurrentError:-ErrorCode) + ', ' + (error_currenterror);    Else;	$speakBubble='The update FAILED. More info: ' + 	(Error_CurrentError:-ErrorCode) + ', ' + (error_currenterror);    /If;    Include: $fromMetoRoot + $myInc + 'errorhandler_debug.inc';Else;    If: $lang == 'fi';    $speakBubble='Tietue päivitetty.';    Else;    $speakBubble='The update was successful.';    /If;/If;Include:$fromMetoRoot + $myInc + 'speakBubble.inc';If: $updatebehavior == 1;    // behavior #1: search kept, updated rec shown only if search allows this    // keyvalue removed from hakuinlinestuff//    $hakuinlinestuff -> //     (remove: ($hakuinlinestuff -> (findPosition:'-KeyValue')) -> first);    Else: $updatebehavior == 2;    // behavior #2: search bypassed, only updated rec shown    // searchdata emptied    Iterate: $searchFields,(Variable:'this');    Variable:('haku'+ ($this->(Get:1))) = '';    /Iterate;    $hakuinlinestuff = (Array);    $linkstuff = (Array);    // maxrecs-arvojen restaurointi    If:   $viewtype == 'listview';	$hakuinlinestuff -> (Insert:'-MaxRecords' = $maxrecords_listview); 	Else: $viewtype == 'formview';	$hakuinlinestuff -> (Insert:'-KeyValue' = $keyvalue); 	$hakuinlinestuff -> (Insert:'-MaxRecords' = $maxrecords_formview); 		// tämä ei toimi listview-näkymässä    /If;         Variable:'keyvalue'=(KeyField_Value);/If;/Inline;?>[Else: $action == 'delete_action']<p class="center"><b>[If: $lang == 'fi']Poistetaanko tietue?[Else]Delete the record?[/If]</b></p><?LassoScript// patch for uploadfile deleteVar:'temp' = '';    If: $allowFileupload == 'yes';	    // LASSOBLOGGER SPECIAL COMMENT	    // vars upl_path and upl_name are db fields,	    // vars should exist in case the page is upl-fileedit.lasso        If: (Variable_Defined:'upl_path') &&  (Variable_Defined:'upl_name');//        $temp = '&file=' + (Encode_URL:$upl_path + $upl_name);        $temp = '<input type="hidden" name="file" value="' 	    + $upl_path + $upl_name + '">';        /If;    /If;?><form class="center" action="[$myfilename]" method="POST">[$formstuff][$temp]<input type="hidden" name="keyvalue" value="[$keyvalue]"><input type="hidden" name="skip" value="[$skip]"><INPUT TYPE="Submit" NAME="delet2_action" VALUE="Ok"><INPUT TYPE="Submit" NAME="-nothing" VALUE="[If: $lang=='fi']Peru[Else]Cancel[/If]"></FORM>[Abort]<?LassoScript //>// old code// <p class="center"> <A HREF="[$myfilename]?[$linkstuff]delet2_action=yes&keyvalue=[$keyvalue][$temp]">[If: $lang=='fi']Ok[Else]Ok[/If] &raquo;</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// // <A HREF="[$myfilename]?// [$linkstuff]skip=[$skip]">[If: $lang=='fi']Peru[Else]Cancel[/If] &raquo;</A></p>Else: $action == 'delet2_action'; // delet2_actioninline: $dbConfig, -table=$table_prefix+$myTable,-KeyField='id',-KeyValue=$keyvalue,-delete;If: (Error_CurrentError)!=(Error_NoError);    If: $lang == 'fi';    $speakBubble = 'Tietueen poistaminen ei onnistunut. Tietoja virheestä:';    Else;    $speakBubble = 'The delete operation FAILED. More info:';    /If;    $speakBubble += (Error_CurrentError:-ErrorCode)+', '+(error_currenterror);    $dbChange_error = (Error_CurrentError);Else;    If: $lang == 'fi';    $speakBubble = 'Tietue poistettu.';    Else;    $speakBubble = 'A record has been deleted.';    /If;/If;Include:$fromMetoRoot + $myInc + 'speakBubble.inc';/Inline;// Iterate: $searchFields,(Variable:'this');// Variable:('haku'+$this) = '';// /Iterate;Else: $action == 'add_action' && $dbChange_error == '';   // add_actionInline: $dbConfig, -table=$table_prefix+$myTable,-KeyField='id',-KeyValue=$keyvalue,$inlinestuff,-add;If: (Error_CurrentError)!=(Error_NoError);	$dbChange_error = (Error_CurrentError);    If: $lang == 'fi';    $speakBubble += 'Tietueen lisääminen ei onnistunut. Tietoja virheestä: ';    Else;    $speakBubble += 'The add operation FAILED. More info: ';    /If;$speakBubble += (Error_CurrentError:-ErrorCode) + ', ' + (error_currenterror);Include: $fromMetoRoot + $myInc + 'errorhandler_debug.inc';Include:$fromMetoRoot + $myInc + 'speakBubble.inc';Abort;Else;    If: $lang == 'fi';    $speakBubble += 'Tietue lisätty.';    Else;    $speakBubble += 'A record has been added.';    /If;/If;Include:$fromMetoRoot + $myInc + 'speakBubble.inc';    Variable:'keyValue'=(KeyField_Value);    // searchdata reset    If:   $viewtype == 'formview';      $hakuinlinestuff = $defaultSearch;      $hakuinlinestuff -> (Insert:'-keyValue' = $keyValue);    /If;/Inline;Else: $action == 'upload';    // first some checks with abort action	// are uploads switched on?	If: (LB_GetOption:'use_fileupload') != 1;	    $speakBubble += 'File uploads are not allowed in Options!<br>';	/If;	// user privileges?	If: $userlevel_ses >= (LB_GetOption:'fileupload_minlevel');	    $speakBubble += 'Your userlevel is too low! ' + 	    	'Uploads are not allowed.<br>';	/If;	// has the user defined a file to upload?	Var: 'uploadErr' = 0;	If: !(File_Uploads -> Size);	    $speakBubble += 'Please give a file to upload!<br>';	/If;	If: $speakBubble != '';	    Include: $fromMeToRoot + $myInc + 'speakBubble.inc';	    Abort;	/If; // set username & passwordInline: $dbConfig,		-Nothing;    // BEGIN VALIDATIONS    // content_path (set in Options) has already been validated (above)    // validate upload_path    If: !($upload_path -> Size);	$speakBubble += 'Please give an upload path!<br>';	$uploadErr = 21;    Else: $upload_path -> Size == 1;	$speakBubble += 'The upload path should be longer than 1 char!<br>';	$uploadErr = 22;    Else;	If: $upload_path >> ' ';	    $speakBubble = 'The upload path should NOT contain spaces! ' +		    'Please correct!<br>'; 		    $uploadErr = 23;	/If;	If: !($upload_path -> (EndsWith:'/'));	    $upload_path += '/';	/If;	If: $upload_path -> (BeginsWith:'/');	    $speakBubble += 'The upload path should NOT begin with a slash! ' +		    'Please correct!<br>';	    $uploadErr = 24;	/If;    /If;    // validate upload_filename    If: !($upload_filename);	$speakBubble += 'Please give a filename.<br>';	$uploadErr = 31;    Else;        // check for illegal chars	If: (string_findregexp: $upload_filename, 	-find="[^a-z0-9\\!\\@\\#\\$\\%\\(\\)\\{\\}\\-\\_\\+\\~\\,\\.]", -ignorecase)->size > 0;	$speakBubble += 'Please don\'t use special characters or spaces in the filename.<br>';	$uploadErr = 32;	/if;	// dot(s) and suffixes	Var:'aName' = $upload_filename -> (Split:'.');	If: $aName -> Size == 1;	    $speakBubble += 'Please give the file suffix ' + 	    	'(for example ".jpg") in the filename.<br>';	    $uploadErr = 33;	Else: $aName -> Size > 2;	    $speakBubble += 'Please use only one dot (.) in the filename.<br>';	    $uploadErr = 34;	Else: $aName -> Size == 2; // ok case	    Var:'suffix' = $aName -> (Get:2);	    Var:'allowedSx' = (LB_GetOption:'fileupload_allowedtypes') 	    	-> (Split:' '); 	    If: $allowedSx -> (Find:$suffix) == (Array);		$speakBubble += 'The file suffix .' + $suffix +			' is not allowed.<br>';		$uploadErr = 35;	    /If;	/If;    /If;// 'test: filename = '; $upload_filename; '<br>';// 'test: cont path = '; $content_path; '<br>';// 'test: upload path = '; $upload_path; '<br>';// validate folder names & create folders    Var: 'aPath' = ($content_path + $upload_path) -> (Split:'/');    $aPath -> (Remove:1); $aPath -> (Remove);    // 'test: ' + $aPath + '<br>';    var:'i' = String; var:'j' = String;    Iterate: $aPath, $i;        $j += '/' + $i;	If: (File_Exists: $j) && (File_IsDirectory:$j);	    // 'test: ' + $j + ' exists!<br>';	Else;	    File_create: ($j + '/');	    If: (File_CurrentError) == 'No error';	    $speakBubble += 'The directory ' + $j + ' was created! You may have to manually check its permissions; the user "Lasso" should have full rights to the directory.<br>';	    Else;	    $speakBubble += 'Tried to create the directory ' + $j + ' but	    encountered an error: ' + (File_CurrentError) + '. Please check a)	    file permissions and b) your blog user privileges set on Lasso\'s admin pages. See blog docs in <code>docs/lb_uploads.txt</code><br>';	    /If;	/If;    /Iterate;    Var:'mThisfile' 	= (File_Uploads) -> (Get:1);    // validate file size     If: $mThisfile -> (Find:'Upload.size') == 0;	$speakBubble += 'The file size seems to be 0. ' + 		'Does the given file really exist?<br>';	$uploadErr = 41;    Else: $mThisfile -> (Find:'Upload.size') > (1000 * (Integer:(LB_GetOption:'fileupload_maxk')));	$speakBubble += 'The file size (' + $mThisfile->(Find:'Upload.size') + 		') exceeds the max size set in Options!<br>';	$uploadErr = 42;    /If;// check that the file doesn't exist yet    If: $uploadErr == 0;    If: (File_Exists:$content_path + $upload_path + $upload_filename);	$speakBubble += 'In the given directory there already exists a file with this name. Delete it first, or use another name!<br>';	$uploadErr = 51;    /If;    /If;// END validations & folder manipulations// do the upload    If: $uploadErr == 0;	File_Copy: $mThisfile -> (Find:'Upload.Name'), 		$content_path + $upload_path + $upload_filename, -FileOverwrite;	    If: (File_CurrentError:-ErrorCode) == 0;		If: $lang == 'fi';		$speakBubble += 'Tiedostonsiirrossa ei raportoitu virheitä.<br>';		$speakBubble += 'Polku on ' + $content_path + $upload_path + $upload_filename + '.<br>';		$speakBubble += 'Voit hallita tiedostoja näiden ylläpitosivujen osastossa Uploads.<br>';		Else;		$speakBubble += 'No errors were reported in file upload.<br>';		$speakBubble += 'The path is ' + $content_path + $upload_path + $upload_filename + '.<br>';		$speakBubble += 'You can manage your uploaded files in the Uploads section of these admin pages.<br>';		/If;	    Else;		$uploadErr = 91;		$speakBubble += 'Errors were reported in file upload.';		$speakBubble += 'More info: ' + File_CurrentError + '<br>';	    /If;    Else; // case uploadErr	    $speakBubble += 'Upload was not executed. ' + 		'Error code was ' + $uploadErr + '.<br>';    /If;/Inline;    // now handle database entries    If: $upl_catid == ''; $upl_catid = '-1'; /If;        If: $uploadErr == 0; // if everything is ok so far	inline: $dbConfig, -table=$table_prefix+'uploads',	    'upl_postid'= $KeyValue,	    'upl_catid'= $upl_catid,	    'upl_name'=$upload_filename,	    'upl_path'=($content_path + $upload_path),	    'upl_description'=$upload_description,	    'upl_created'=$nowMySQL,	    'upl_modified'=$nowMySQL,	    'upl_userid'=$user_ses,	    -Add;	If: (Error_CurrentError)!=(Error_NoError);		$dbChange_error = (Error_CurrentError);	    If: $lang == 'fi';	    $speakBubble += 'Tietueen lisääminen ei onnistunut. ' + 	    	'Tietoja virheestä: ';	    Else;	    $speakBubble += 'The add db operation FAILED. More info: ';	    /If;	    $speakBubble += (Error_CurrentError:-ErrorCode) + ', ' + 	    	(error_currenterror);	    // Include: $fromMetoRoot + $myInc + 'errorhandler_debug.inc';	    // 'test: keyval = ' + $keyvalue + '<br>';	Else;	    If: $lang == 'fi';	    $speakBubble += 'Tietue lisätty.';	    Else;	    $speakBubble += 'A record has been successfully added to the db.';	    /If;	/If;	/Inline;    /If; // end if uploadErr == 0    // END handling database entries    If: $speakBubble != '';	Include:$fromMetoRoot + 'inc/speakBubble.inc';    /If;/If;   // end if action/If;   // if dbChange=1//  *** hakulomake / search form *** // test, if searchform should be shownVar:'showToggle' = '';    // check searchFields    If: $searchFields != (Array); 	Iterate:$searchFields, (Var:'this');	    If: $this -> (Get:3) != 'hidden';	    $showToggle = 'show';	    /If;	/Iterate;    /If; If: $showToggle == 'show'; // there are showable searchfields, so show!?><form action="[$myfilename]" method="POST"><input type="hidden" name="searchtype" value="post"><table cellpadding="2" cellspacing="2" class="center"><tr BGCOLOR="#CCCCCC"><td class="pieni" align="center" colspan="2"><B>[If: $lang == 'fi']Hae [$rectype_fi_part][Else]Search [$rectype_en_part][/If] [If: $lang == 'fi']editoitavaksi[Else]to be edited[/If]:</B></td></tr><tr><td class="pieni"><?LassoScript //>Variable:'nobreak_setting' = ''; // used to pass info from prev searchfield 				 // to the next one    // have to check first, if there are nobreak-settings    Variable:'nobreak_exists' = '';	Iterate: $searchFields, (Var:'this');	    If: $this -> (Get:10) == 'nobreak';	    $nobreak_exists = 'yes';	    /If;	/Iterate;Variable:'fieldCounter' = 0; 	// actionparam names will be "searchparam1" etc.Iterate: $searchFields, (Var:'this');$fieldCounter += 1;If: $this -> (Get:3) != 'hidden';// break or nobreak?    If: ($fieldCounter != 1 && $nobreak_setting == 'nobreak') ||         ($fieldCounter == 1 && $this -> (Get:10) == 'nobreak');     				// setting of prev record used here	'&nbsp;&nbsp;'; $this -> (Get:2); '&nbsp;';	// kentän nimi    Else: ($fieldCounter != 1 && $nobreak_setting != 'nobreak') ||          ($fieldCounter == 1 && $this -> (Get:10) != 'nobreak');     				// nobreak_setting!='nobreak && not 1st rec	// kentän nimi	'<tr><td class="pieni">' + $this -> (Get:2);	// contents cell	If: $nobreak_exists != 'yes';	    '</td><td class="pieni">';	/If;    /If;    $nobreak_setting = $this -> (Get:10); // setting updated    Variable:'fname'= $this -> (Get:1);		   // for links & db search    Variable:'fname_forForms'= 'searchparam' + $fieldCounter;// for forms    // capture searchparam value to var    If: $searchType == 'post';	Var:'i' = (Action_Param:$fname_forForms);     Else: $searchType == 'link'; // searchType=get	Var:'i' = (Action_Param:$fname_forForms);     Else; // searchType=get	Var:'i' = (Action_Param:$fname);     /If;    //	'test: ' + $i;// date - muunna pvm    If: ($this -> (Get:8)) >> 'date' && $i != ''; 	If: (Date:$i,-Format=$date_showformat) -> Type != 'date';// date not valid	    Variable:'fieldvalue' = $i;	    If: $lang == 'fi';	    $speakBubble = 'Hakupäivämäärässä tuntuu olevan jotain vikaa - tarkista!';	    Else;	    $speakBubble='The search date seems to be malformed - please check!';	    /If;	Else; 					// date is valid	    Variable:'fieldvalue' = $i;	/If; 					// end if valid    Else;					// case: not date    Variable:'fieldvalue' = $i;    /If; // 'test:i=' + $i + ',fv=' + $fieldvalue;// end date muunna pvm If: ($this -> (Get:3)) == 'text'; 	// case text'<input type=\"' + ($this -> (Get:'3')) + '\" name=\"';'searchparam' + $fieldCounter;    '\" size=\"';	If: ($this -> (Get:5)) == ''; // use default size	$size1default; Else; ($this -> (Get:5)); 	/If;    '\" value=\"' + $fieldvalue + '\">';    $this -> (Get:7); // helppiteksti    ' \r';Else: ($this -> (Get:3)) == 'select';	// case selectVariable:'valuelist' = ($this -> (Get:5)) -> (Split:';');Variable:'showlist' = ($this -> (Get:6)) -> (Split:';');'\r<select name=\"searchparam' +  $fieldCounter;'\" size=\"1\">\r';Loop: ($valuelist -> Size);    '<option value=\"' + ($valuelist -> (Get:(Loop_Count))) + '\"';    If: $fieldvalue == ($valuelist -> (Get:(Loop_Count)));     ' SELECTED';    /If;    '>' + ($showlist -> (Get:(Loop_Count))) + '</option>\r';/Loop;    ($this -> (Get:7)); // helppiteksti'</select>\r';Else: ($this -> (Get:3)) == 'radio';	// case radioVariable:'valuelist' = ($this -> (Get:5)) -> (Split:';');Variable:'showlist' = ($this -> (Get:6)) -> (Split:';');Loop: ($valuelist -> Size);'\r<INPUT TYPE=\"radio\" NAME=\"searchparam' +      $fieldCounter + '\" VALUE=\"';($valuelist -> (Get:(Loop_Count))) + '\"';    If: $fieldvalue == ($valuelist -> (Get:(Loop_Count)));     ' CHECKED';    /If;'> ' + ($showlist -> (Get:(Loop_Count))) + ' \r';/Loop;    ($this -> (Get:7)); // helppiteksti    '\r';Else: ($this -> (Get:3)) == 'override'; 	// case override    If: $this -> (Get:9) != '';	Process:$this -> (Get:9); 	// custom code	    /* this will include the fielvalue from db, 	        if #9 refers to [$fieldvalue] */    /If;    ($this -> (Get:7)); 		// help text    ' \r';/If; // end type    If: ($this -> (Get:10)) != 'nobreak'; // break or nobreak?    '</td></tr>';    /If;/If; // end if hidden/Iterate;?></td><td><INPUT TYPE="Submit" NAME="-nothing" VALUE="[If: $lang == 'fi']Hae[Else]Search[/If]"><INPUT TYPE="Hidden" NAME="-nothing" VALUE="Hae"></td></tr></table></FORM><?LassoScript //>	// end hakulomake/If; 	// end if searchFields != (Array)// custom searchvalidations     If: (Variable_Defined:'searchValidations');	If: $searchValidations == 'yes';	Include:$fromMetoRoot + 'admin/custom/searchvalidation/' 	    + $myfilebody + '.inc';	/If;    /If;// speakBubble for searchvalidations 			    If: $speakBubble != '';			    Include: $fromMetoRoot + $myInc + 'speakBubble.inc';			    Abort;			    /If;If: $searchBehavior == 2 && $searchToggle == '';	// there are no search terms	If: $lang == 'fi';	$speakBubble='Ole hyvä ja anna hakukriteerejä!';	Else;	$speakBubble='Please do a search!';	/If;    Include:$fromMetoRoot + $myInc + 'speakBubble.inc';    Abort; /If;// 'test: hakuinlinestuff pre main search = ' + $hakuinlinestuff + '<br>';// the main searchinline: -search, $dbConfig, -table=$table_prefix+$myTable,    -KeyField='id',    $hakuinlinestuff,    -skipRecords=$skip,    $sortstuff;// show diagnostic values// Include: $fromMetoRoot + $myInc + 'errorhandler_debug.inc';Variable:'foundCount' = (Found_Count);Variable:'errorcode' = (Error_CurrentError:-ErrorCode);if: $action == 'delet2_action';Else: (($errorcode == '-1728' 	&& $dbType == 'fmp')   || ($foundCount == 0 	&& $dbType == 'mysql')   || $errorcode == '26279936' 	&& $dbType == 'fmp')   && $dbChange == 1;   // no records found, though there really should have been...   If: $dbChange_error == ''; // if validation failed, don't tell	    If: $lang == 'fi';	    $speakBubble='Virhe - Tietueita ei l&ouml;ytynyt!';	    Else;	    $speakBubble='Error - No records were found!';	    /If;	Include:$fromMetoRoot + $myInc + 'speakBubble.inc';	Include:$fromMetoRoot + $myInc + 'errorhandler_debug.inc';    /If;Else: (($errorcode == '-1728'   && $dbType == 'fmp')    || ($foundcount == 0        && $dbType == 'mysql')    || $errorcode == '26279936' && $dbType == 'fmp');    // no records found, but it's no big deal	If: $emptyForm == 'yes';	    // don't tell nothing was found	Else;	    If: $lang == 'fi';		$speakBubble= (LB_titleCase:$rectype_fi_part) + ' ei löytynyt';		Else;		$speakBubble='No ' + $rectype_en_part + ' were found';	    /If;	    Include:$fromMetoRoot + $myInc + 'speakBubble.inc';	    $emptyform = 'yes'; // added 060726	/If;Else: (Error_CurrentError) != (Error_NoError);    If: $lang == 'fi';    $speakBubble='Tapahtui virhe. Tietoja virheest&auml;: ';    Else;    $speakBubble='An error occurred! More info: ';    /If;    $errorcode + ', ' + (error_currenterror);    Include:$fromMetoRoot + $myInc + 'speakBubble.inc';/If;// custom postprocess    If: (Variable_Defined:'customPostprocess');	If: $customPostprocess == 'yes';	Include:$fromMetoRoot + 'admin/custom/postprocess/' 	    + $myfilebody + '.inc';	/If;    /If;// naviglinks// don't show, if action=add)If: !(Variable_Defined:'showNaviglinks');    Variable:'showNaviglinks' = '';    If: $action == 'add_action';    $showNaviglinks = 'no';    /If;    If: (Found_Count) < 1;	$showNaviglinks = 'no';    /If;    If: $emptyForm == 'yes';	$showNaviglinks = 'no';    /If;/If;If: $showNaviglinks != 'no';    // If: $viewtype == 'formview';	Include:$fromMetoRoot + $myInc + 'snip_naviglinks.inc';	Include:$fromMetoRoot + $myInc + 'snip_hr.inc';	'<br>';    // /If;Else;    '<br>';/If;?>[Output_None]   ***  editointilomake  ***   [/Output_None]<TABLE CELLSPACING="2" CELLPADDING="0" class="editform"><?LassoScript //>// define what should be iteratedIf: $emptyForm == 'yes';                // otherwise show empty form            Var:'iterated' = $addFields;    Else;    Var:'iterated' = $editFields;    /If;// If: $emptyForm == 'yes' || ($emptyForm != 'yes' && (Found_Count) > 0);		// show header texts only if there is a form    if: ($viewtype == 'listview') && 			// case listview	!($action == 'delet2_action' && (Found_Count) == 0);    '<tr>';   				// nimilaput    Iterate: $iterated, (Var:'this');	If: ($this -> (Get:3)) != 'hidden' 	    && $this -> (Get:3) != 'moddate'	    && $this -> (Get:3) != 'creationdate';	    '<th scope="col" STYLE="text-align:left;padding-right:10px;">'; 	    $this -> (Get:2); // nimilappu		If: ($this -> (Get:4)) >> 'req'; 		$reqFieldsFound = 'yes';		'*'; 		/If; // if pakollinen kenttä	    '</th>\r';	/If;    /Iterate;    '</tr>\r';    '<tr>';				// helppitekstit    Iterate: $iterated, (Var:'this');	If: ($this -> (Get:7)) != ''; // helppiteksti	    '<td valign="top" class="' + $defaultClass + '">'; 	    $this -> (Get:7); // helppiteksti	    '</td>\r';	/If;    /Iterate;    '</tr>\r';    /If; 					// end case listview// /If;						// end emptyform etc.Records;If: ($emptyForm != 'yes'  && $dbChange  != 1)   || $action == 'update_action'   || ($action == 'add_action' && $dbChange_error == '')  || ($action == 'delet2_action' && (Found_Count) > 0)  || $action == 'upload';     // for this case: show editform & upload form & filemove form    // for other cases, show only empty form (scroll down)//    'test'; 'empty '; $emptyForm; ', action'; $action;//    ', val.'; $dbChange_error;?><form name="MyForm" action="[$formTargetpage]" method="POST"><input type="hidden" name="searchType" value="post"><input type="hidden" name="-ResponseRequiredFieldMissingError" value="[$myfilename]"><input type="hidden" name="keyvalue" value="[KeyField_Value]">[$formstuff][Var:'COMMENT'='* hakumuuttujat *']<input type="hidden" name="skip" value="[$skip]"><?LassoScript    // edit form    Include: $fromMetoRoot + 'inc/admin_editform.inc';'</FORM>';    // file upload form (will come again for addform, sorry!    If: $allowFileupload == 'yes';	If: (LB_GetOption:'use_fileupload') == 1	    && (Integer:$userlevel_ses) >= 	       (Integer:(LB_GetOption:'fileupload_minlevel'))	    && (Loop_Count) == (Shown_Count); // last one is for listview    '<tr STYLE="">';?><form name="fileUpload" action="[$formTargetpage]" method="POST" enctype="multipart/form-data">    <input type="hidden" name="-ResponseRequiredFieldMissingError" value="[$formTargetpage]">    <input type="hidden" name="keyvalue" value="[KeyField_Value]">    [$formstuff][Var:'COMMENT'='* hakumuuttujat *']    <input type="hidden" name="skip" value="[$skip]">    <th align="right" valign="top" style="padding:20px 10px 0 0;border-top:1px solid black;">File upload</th>    <td STYLE="border-top:1px solid black; padding-top:20px;" colspan="10">    <table>	<tr><td>File to upload*</td>	<td colspan="2"><input type="file" name="upload" value=""></td>	</tr>	<?LassoScript    // LASSOBLOGGER SPECIAL	If: $myfilename != 'man-postedit.lasso';	'<tr><td>Category</td>';	'<td colspan="2">';	    Inline:-FindAll,$dbConfig,		  -table=$table_prefix+'uploadcats',		  -KeyField='id',		  -SortField='upc_name';		'<select name="upl_catid" size="1">\r';		    Records;			'<option value="'; Field:'id'; '">'; Field:'upc_name';			'</option>\r';		    /Records;		'</select>';	    /Inline;	'</td>';	'</tr>';	/If; // end if myfilename!=man-postedit.lasso    // END LASSOBLOGGER SPECIAL	?>	<tr>	<td>New name for the file*</td>	<td><input type="text" name="upload_filename" value="[$upload_filename]"></td>	<td>Example: <code>smile.jpg</code>. Do not use spaces or special characters. Remember the file suffix (in the example: <code>.jpg</code>)!</td>	</tr>	<tr>	<td>File Description</td>	<td><input type="text" name="upload_description" value="[$upload_description]"></td>	<td>Recommended: will help you manage your files, and will be shown to blog readers as a tooltip text</td>	</tr>	<?LassoScript	    // LASSOBLOGGER SPECIAL		Var:'temp' = 'uploads/';		If: $myfilename == 'man-postedit.lasso';		    $temp += 'post-related';		    Else;		    $temp += 'filevault';		/If;	    // END LASSOBLOGGER SPECIAL	?>	<tr>	<td>File path*</td>	<td><input type="text" name="upload_path" value="[$temp]"></td>	<td>Relative to the contents path set on the admin page Options > Uploads (currently <code>[$content_path]</code>). The default File path is <code>[$temp]</code>. If specified folders do not exist, LassoBlogger will try to create them for you.</td>	</tr>	<tr><td> </td>	<td>	<INPUT TYPE="Submit" NAME="upload" VALUE="Start upload">	<INPUT TYPE="Hidden" NAME="upload" VALUE="Start upload">	</td></tr>    </table>    </tr></FORM><?LassoScript // '>	/If; // end if option use_fileupload    /If; // end if $allowFileupload    // END upload form & fileMove form/If; // end if (what forms to show)/Records;	If: $allowFileupload == 'yes' && 	    (LB_GetOption:'use_fileupload') != 1;	    '<p>Note: File uploads are disabled in Options</p>';	/If;// don't close the table yet... we may have emptyform=yes/inline;// lisäyslomake If: ((($errorcode == '-1728' && $dbType == 'fmp')	|| ($Foundcount == 0 && $dbType == 'mysql'))	&& $dbChange != 1)     ||  $emptyForm == 'yes'    ||  ($action == 'add_action' && $dbChange_error != '');// the table is still open?><form name="MyForm" action="[$formTargetpage]" method="POST"><input type="hidden" name="searchType" value="post"><input type="hidden" name="lomake" value="addform"><input type="hidden" name="-ResponseRequiredFieldMissingError" value="[$myfilename]"><?LassoScript$formstuff; 		// * hakumuuttujat *$emptyForm = 'yes'; // if we get this far, show empty form anywayInclude: $fromMetoRoot + 'inc/admin_editform.inc';'</FORM>';/If;  // fileupload form, nr 2 (table is still open)    If: $allowFileupload == 'yes' && $uploadform=='yes';	If: (LB_GetOption:'use_fileupload') == 1	    && (Integer:$userlevel_ses) >= 	       (Integer:(LB_GetOption:'fileupload_minlevel'));    '<tr STYLE="">';?><form name="fileUpload" action="[$formTargetpage]" method="POST" enctype="multipart/form-data">    <input type="hidden" name="-ResponseRequiredFieldMissingError" value="[$formTargetpage]">    <input type="hidden" name="keyvalue" value="[KeyField_Value]">    [$formstuff][var:'COMMENT'='* contains search params *']    <input type="hidden" name="skip" value="[$skip]">    <th align="right" valign="top" style="padding:20px 10px 0 0;border-top:1px solid black;">File upload</th>    <td STYLE="border-top:1px solid black; padding-top:20px;" colspan="10">    <table>	<tr><td>File to upload*</td>	<td colspan="2"><input type="file" name="upload" value=""></td>	</tr>	<?LassoScript    // LASSOBLOGGER SPECIAL	If: $myfilename != 'man-postedit.lasso';	'<tr><td>Category</td>';	'<td colspan="2">';	    Inline:-FindAll,$dbConfig,		-table=$table_prefix+'uploadcats',	        -KeyField='id',		-SortField='upc_name';		'<select name="upl_catid" size="1">\r';		    Records;			'<option value="'; Field:'id'; '">'; Field:'upc_name';			'</option>\r';		    /Records;		'</select>';	    /Inline;	'</td>';	'</tr>';	/If; // end if myfilename!=man-postedit.lasso    // END LASSOBLOGGER SPECIAL	?>	<tr>	<td>New name for the file*</td>	<td><input type="text" name="upload_filename" value="[$upload_filename]"></td>	<td>Do not use spaces or special characters. Give the file suffix, too!</td>	</tr>	<tr>	<td>File Description</td>	<td><input type="text" name="upload_description" value="[$upload_description]"></td>	<td>Recommended: will help you manage your files, and will be shown to blog readers as a tooltip text</td>	</tr>	<?LassoScript	    // LASSOBLOGGER SPECIAL		Var:'temp' = 'uploads/';		If: $myfilename == 'man-postedit.lasso';		    $temp += 'post-related';		    Else;		    $temp += 'filevault';		/If;	    // END LASSOBLOGGER SPECIAL	?>	<tr>	<td>File path*</td>	<td><input type="text" name="upload_path" value="[$temp]"></td>	<td>Relative to the contents path set on the admin page Options > Uploads (currently <code>[$content_path]</code>. The default File path is <code>[$temp]</code>. If specified folders do not exist, LassoBlogger will try to create them for you.</td>	</tr>	<tr><td> </td>	<td>	<INPUT TYPE="Submit" NAME="upload" VALUE="Start upload">	<INPUT TYPE="Hidden" NAME="upload" VALUE="Start upload">	</td></tr>    </table>    </tr></FORM><?LassoScript    /If;/If;// end fileupload form, nr 2'</table>';//    ***  end if error=-1728  ***   //    ***  end lisäyslomake    ***   If: $publicPage != '';?><P class="[$defaultClass]" STYLE="text-align:center;margin-left:auto;margin-right:auto;"><FONT SIZE="-1"><A HREF="[$publicPage]" TARGET="_blank">[If:$lang=='fi']Tarkista julkinen sivu (avautuu uuteen ikkunaan)[Else]Check the public page (will open in a new window)[/If]</A>.</FONT></P>[/If]</div> <!-- end center -->